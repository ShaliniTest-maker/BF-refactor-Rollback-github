SECURITY ALERT: ACCESS PATTERN ANOMALY DETECTED

================================================================================
INCIDENT SUMMARY
================================================================================

Incident ID: {{ incident_id }}
Detection Time: {{ detection_timestamp }}
Severity Level: {{ severity_level }}
Risk Score: {{ risk_score }}/100
Alert Type: Access Pattern Anomaly

User Information:
- User ID: {{ user_id }}
- Username: {{ username }}
- Email: {{ user_email }}
- Account Status: {{ account_status }}
- Last Known Location: {{ last_known_location }}

================================================================================
ANOMALY DETECTION DETAILS
================================================================================

BEHAVIORAL ANALYSIS SUMMARY:
- Anomaly Type: {{ anomaly_type }}
- Confidence Level: {{ confidence_level }}%
- Deviation Score: {{ deviation_score }}
- Machine Learning Model: {{ ml_model_name }}
- Training Baseline Period: {{ baseline_period }}

UNUSUAL PATTERNS IDENTIFIED:
{{ #each anomalous_patterns }}
- {{ pattern_type }}: {{ pattern_description }}
  Normal Range: {{ normal_range }}
  Detected Value: {{ detected_value }}
  Deviation: {{ deviation_percentage }}%
{{ /each }}

SESSION ANALYSIS:
- Session Duration: {{ session_duration }} minutes
- Actions Performed: {{ actions_count }}
- Pages Accessed: {{ pages_accessed }}
- Data Downloaded: {{ data_volume }}
- Failed Authentication Attempts: {{ failed_auth_count }}

GEOGRAPHIC ANALYSIS:
- Current Location: {{ current_location }}
- Previous Locations (30 days): {{ previous_locations }}
- Geographic Deviation: {{ geo_deviation }}
- VPN/Proxy Detection: {{ vpn_proxy_status }}
- ISP Information: {{ isp_details }}
- Time Zone Anomaly: {{ timezone_anomaly }}

DEVICE AND BROWSER ANALYSIS:
- Device Type: {{ device_type }}
- Operating System: {{ operating_system }}
- Browser: {{ browser_details }}
- New Device Flag: {{ new_device_flag }}
- Device Fingerprint: {{ device_fingerprint }}
- User Agent Anomaly: {{ user_agent_anomaly }}

================================================================================
RISK ASSESSMENT
================================================================================

RISK SCORE BREAKDOWN:
- Geographic Risk: {{ geo_risk_score }}/25
- Behavioral Risk: {{ behavioral_risk_score }}/25
- Temporal Risk: {{ temporal_risk_score }}/25
- Technical Risk: {{ technical_risk_score }}/25

RISK FACTORS IDENTIFIED:
{{ #each risk_factors }}
- {{ factor_name }}: {{ factor_severity }} ({{ factor_description }})
{{ /each }}

POTENTIAL THREAT INDICATORS:
{{ #if credential_stuffing_detected }}
- Possible credential stuffing attack detected
{{ /if }}
{{ #if account_takeover_risk }}
- Account takeover risk indicators present
{{ /if }}
{{ #if data_exfiltration_risk }}
- Potential data exfiltration patterns observed
{{ /if }}
{{ #if privilege_escalation_attempt }}
- Privilege escalation attempt indicators
{{ /if }}

================================================================================
INVESTIGATION PROCEDURES
================================================================================

IMMEDIATE ACTIONS REQUIRED:
1. Review user activity logs for the time period: {{ investigation_time_window }}
2. Verify user identity through out-of-band communication
3. Check for concurrent sessions from multiple locations
4. Examine recent privilege changes or access grants
5. Review data access and download patterns

DETAILED INVESTIGATION STEPS:

1. USER VERIFICATION:
   - Contact user at verified phone number: {{ verified_phone }}
   - Verify recent login activities with user
   - Confirm user's current location and device usage
   - Check if user shared credentials or account access

2. TECHNICAL ANALYSIS:
   - Review full session logs in security monitoring dashboard
   - Analyze network traffic patterns for anomalies
   - Check authentication logs for failed attempts
   - Examine API calls and data access patterns

3. CORRELATION ANALYSIS:
   - Cross-reference with other user accounts showing similar patterns
   - Check for related security incidents in the same time window
   - Review GuardDuty findings for associated threats
   - Analyze CloudWatch logs for system-level anomalies

4. IMPACT ASSESSMENT:
   - Identify all systems and data accessed during anomalous session
   - Determine if sensitive data was viewed or downloaded
   - Assess potential data exposure or system compromise
   - Document all affected resources and access levels

================================================================================
RESPONSE PROCEDURES
================================================================================

INCIDENT RESPONSE ACTIONS:

IMMEDIATE (0-15 minutes):
- [ ] Acknowledge alert in security monitoring system
- [ ] Review user session in real-time monitoring dashboard
- [ ] Contact user for verification if session is active
- [ ] Document initial findings in incident tracking system

SHORT-TERM (15-60 minutes):
- [ ] Complete technical analysis of session logs
- [ ] Verify user identity and legitimacy of access
- [ ] If confirmed malicious: initiate account lockdown procedures
- [ ] Escalate to security team lead if risk score >75

ESCALATION CRITERIA:
- Risk Score >80: Immediate escalation to CISO
- Data exfiltration detected: Immediate escalation to legal team
- Multiple accounts affected: Escalate to incident response team
- Confirmed account compromise: Activate breach response procedures

CONTAINMENT ACTIONS (if compromise confirmed):
1. Immediately suspend user account access
2. Revoke all active authentication tokens
3. Reset user password and require MFA re-enrollment
4. Review and revoke any recently granted permissions
5. Monitor for additional compromise indicators

RECOVERY PROCEDURES:
1. Conduct thorough security assessment of affected systems
2. Implement additional monitoring for affected user account
3. Provide security awareness training to affected user
4. Update detection rules based on incident learnings

================================================================================
MONITORING AND FOLLOW-UP
================================================================================

CONTINUOUS MONITORING:
- Enhanced monitoring enabled for user account: {{ enhanced_monitoring_duration }}
- Additional alerting thresholds activated
- Behavioral baseline re-training scheduled
- Follow-up review scheduled: {{ follow_up_date }}

DOCUMENTATION REQUIREMENTS:
- Complete incident report within 24 hours
- Update security playbook with lessons learned
- Document any new detection patterns identified
- Share findings with security team for threat intelligence

COMPLIANCE CONSIDERATIONS:
{{ #if gdpr_applicable }}
- GDPR breach notification assessment required
{{ /if }}
{{ #if hipaa_applicable }}
- HIPAA incident reporting procedures apply
{{ /if }}
{{ #if sox_applicable }}
- SOX compliance documentation required
{{ /if }}

================================================================================
CONTACT INFORMATION
================================================================================

PRIMARY CONTACTS:
- Security Operations Center: {{ soc_phone }} / {{ soc_email }}
- Security Team Lead: {{ team_lead_phone }} / {{ team_lead_email }}
- Incident Response Team: {{ ir_team_phone }} / {{ ir_team_email }}

ESCALATION CONTACTS:
- CISO: {{ ciso_phone }} / {{ ciso_email }}
- IT Manager: {{ it_manager_phone }} / {{ it_manager_email }}
- Legal Team: {{ legal_team_phone }} / {{ legal_team_email }}

EXTERNAL RESOURCES:
- Threat Intelligence Provider: {{ threat_intel_contact }}
- External Incident Response: {{ external_ir_contact }}
- Law Enforcement Liaison: {{ law_enforcement_contact }}

================================================================================
SYSTEM INFORMATION
================================================================================

Detection System: Flask Security Monitoring Framework
Machine Learning Engine: {{ ml_engine_version }}
Alert Generation Time: {{ alert_generation_time }}
Monitoring Dashboard: {{ dashboard_url }}
Incident Tracking System: {{ incident_tracking_url }}

This alert was generated automatically by the Flask application security 
monitoring system. For technical support, contact the system administrators
at {{ system_admin_email }}.

CONFIDENTIAL: This communication contains security-sensitive information
and should be handled according to organizational security policies.

================================================================================