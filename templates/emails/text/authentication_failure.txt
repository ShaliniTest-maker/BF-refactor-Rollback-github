SECURITY ALERT: Authentication Failure Detected

================================================================
SECURITY INCIDENT NOTIFICATION
================================================================

INCIDENT OVERVIEW
-----------------
A security incident has been detected involving multiple failed authentication attempts on your account. This notification is generated by our Flask application security monitoring system in accordance with our security architecture protocols.

INCIDENT DETAILS
----------------
Timestamp: {{ incident_timestamp }}
Incident ID: {{ incident_id }}
User Account: {{ username }}
Email Address: {{ email_address }}
Account Status: {{ account_status }}

AUTHENTICATION ATTEMPT DETAILS
------------------------------
Source IP Address: {{ source_ip }}
Geolocation: {{ ip_geolocation }}
User Agent: {{ user_agent }}
Request Path: {{ request_path }}
Authentication Method: {{ auth_method }}
Failed Attempts Count: {{ failed_attempts_count }}
Time Range: {{ time_range_start }} to {{ time_range_end }}
Auth0 Session ID: {{ auth0_session_id }}

SECURITY CONTEXT
----------------
Detection Method: {{ detection_method }}
Risk Level: {{ risk_level }}
AWS GuardDuty Status: {{ guardduty_status }}
CloudWatch Alarm: {{ cloudwatch_alarm_name }}
Sentry Event ID: {{ sentry_event_id }}

FAILURE REASONS
--------------
{{ failure_reasons }}

TECHNICAL DETAILS
-----------------
Flask Application Instance: {{ flask_instance_id }}
Container ID: {{ container_id }}
ECS/EKS Cluster: {{ cluster_name }}
Gunicorn Worker PID: {{ gunicorn_worker_pid }}
SQLAlchemy Session: {{ sqlalchemy_session_id }}
Request ID: {{ request_id }}

IMMEDIATE ACTIONS TAKEN
----------------------
{% if automated_actions_taken %}
Our security system has automatically implemented the following protective measures:

{% for action in automated_actions_taken %}
- {{ action }}
{% endfor %}
{% endif %}

SECURITY RECOMMENDATIONS
------------------------

FOR ACCOUNT HOLDERS:
-------------------
1. IMMEDIATE ACTIONS REQUIRED:
   - Change your password immediately if you have not done so recently
   - Review and update your account recovery information
   - Enable Multi-Factor Authentication (MFA) if not already active
   - Check recent login activity in your account settings

2. SECURITY REVIEW:
   - Verify the source IP address {{ source_ip }} is not from your location
   - Scan your devices for malware using updated antivirus software
   - Review any shared accounts or saved passwords
   - Consider using a password manager for enhanced security

3. CONTACT INFORMATION:
   - If this was a legitimate login attempt, contact support immediately
   - If you recognize the activity, no further action is required
   - Report any suspicious activity to our security team

FOR SECURITY TEAMS:
------------------
1. INCIDENT RESPONSE:
   - Incident classification: {{ security_classification }}
   - Escalation level: {{ escalation_level }}
   - Response team assigned: {{ response_team }}
   - SLA requirement: {{ sla_requirement }}

2. INVESTIGATION PRIORITIES:
   - Correlate with AWS GuardDuty findings for IP {{ source_ip }}
   - Review CloudWatch Container Insights for anomalous activity
   - Analyze Sentry error tracking for related security events
   - Cross-reference with threat intelligence feeds

3. TECHNICAL ANALYSIS:
   - Flask-JWT-Extended token validation logs
   - Auth0 Python SDK 4.9.0 authentication flow analysis
   - ItsDangerous session security validation
   - SQLAlchemy connection pool security review

4. MONITORING ACTIONS:
   - Enhanced monitoring enabled for user account {{ username }}
   - IP address {{ source_ip }} added to watchlist
   - Prometheus alerting rules updated for similar patterns
   - Container isolation procedures reviewed for affected instance

SYSTEM INFORMATION
-----------------
Detection System: Flask Security Monitoring Framework
Authentication Provider: Auth0 (Python SDK 4.9.0)
Session Management: Flask-Login with ItsDangerous 2.2+
Container Platform: {{ container_platform }}
Database: PostgreSQL with Flask-SQLAlchemy 3.1.1
Encryption: AWS KMS integration with field-level encryption

COMPLIANCE AND AUDIT
--------------------
This incident has been logged in accordance with:
- Security architecture audit requirements
- AWS CloudWatch centralized logging
- Sentry error tracking and performance monitoring
- GDPR data protection compliance procedures

Audit Trail Reference: {{ audit_trail_id }}
Compliance Report: Available in security dashboard
Data Retention: 90 days as per security policy

CONTACT INFORMATION
------------------
Security Team: security@company.com
Emergency Hotline: +1-XXX-XXX-XXXX (24/7)
Support Portal: https://support.company.com/security
Incident Response: incident-response@company.com

IT Support: support@company.com
Business Hours: Monday-Friday, 9 AM - 5 PM EST
Response Time: Critical incidents within 15 minutes

ADDITIONAL RESOURCES
-------------------
Security Best Practices: https://company.com/security-guide
Account Security Settings: https://company.com/account/security
Multi-Factor Authentication Setup: https://company.com/mfa-setup
Password Security Guidelines: https://company.com/password-policy

NEXT STEPS
----------
1. This incident will be monitored for 72 hours
2. Additional alerts will be sent if suspicious activity continues
3. Account will be reviewed by our security team within 24 hours
4. You will receive a follow-up email with the investigation results

DO NOT REPLY TO THIS EMAIL
--------------------------
This is an automated security notification from our Flask application monitoring system. For assistance, please contact our security team using the information provided above.

================================================================
Flask Security Monitoring System | Version {{ system_version }}
Incident Generated: {{ generation_timestamp }}
Message ID: {{ message_id }}
================================================================

This email was sent in plain text format to ensure compatibility with all email clients and accessibility requirements. Our security monitoring system operates 24/7 to protect your account and data.

For immediate assistance with security concerns, please contact our emergency security hotline listed above.

Stay secure,
The Security Team

================================================================