=======================================================================
SECURITY ALERT: Authentication Failure Notification
=======================================================================

INCIDENT DETAILS
-----------------------------------------------------------------------
Timestamp:           {{ incident_timestamp }}
Incident ID:         {{ incident_id }}
Severity Level:      {{ severity_level }}
User Account:        {{ username if username else 'N/A' }}
Source IP Address:   {{ source_ip_address }}
Geographic Location: {{ geographic_location if geographic_location else 'Unknown' }}
User Agent:          {{ user_agent if user_agent else 'N/A' }}

AUTHENTICATION ATTEMPT INFORMATION
-----------------------------------------------------------------------
Attempted Login:     {{ attempted_username if attempted_username else 'Unknown' }}
Authentication Type: {{ auth_method if auth_method else 'Standard Login' }}
Failure Reason:      {{ failure_reason }}
Attempt Count:       {{ attempt_count }} of {{ max_attempts }} allowed attempts
Session ID:          {{ session_id if session_id else 'N/A' }}
Request Path:        {{ request_path if request_path else '/login' }}
HTTP Method:         {{ http_method if http_method else 'POST' }}

SECURITY CONTEXT
-----------------------------------------------------------------------
{% if multiple_failures %}
** MULTIPLE FAILURE PATTERN DETECTED **
Previous attempts:   {{ previous_attempt_count }} in last {{ time_window }}
First attempt:       {{ first_attempt_time }}
Pattern indicates:   {{ threat_assessment }}
{% endif %}

{% if suspicious_indicators %}
** SUSPICIOUS ACTIVITY INDICATORS **
{% for indicator in suspicious_indicators %}
- {{ indicator }}
{% endfor %}
{% endif %}

Account Status:      {{ account_status }}
IP Reputation:       {{ ip_reputation if ip_reputation else 'Checking...' }}
Rate Limit Status:   {{ rate_limit_status if rate_limit_status else 'Normal' }}

IMMEDIATE ACTIONS TAKEN
-----------------------------------------------------------------------
{% if actions_taken %}
{% for action in actions_taken %}
- {{ action }}
{% endfor %}
{% else %}
- Incident logged for security analysis
- User account security review initiated
- IP address monitoring activated
{% endif %}

{% if account_locked %}
** ACCOUNT SECURITY PROTECTION **
Your account has been temporarily secured due to repeated authentication
failures. This is a protective measure to prevent unauthorized access.
{% endif %}

IF YOU ARE THE LEGITIMATE ACCOUNT HOLDER
-----------------------------------------------------------------------
If this was a legitimate login attempt:

1. IMMEDIATE STEPS:
   - Verify your password is correct
   - Check for any typing errors or caps lock
   - Clear your browser cache and cookies
   - Try logging in from a different browser or device

2. SECURITY VERIFICATION:
   - Change your password immediately if you suspect compromise
   - Review your recent account activity
   - Check for any unauthorized changes to your profile
   - Enable multi-factor authentication if not already active

3. ACCOUNT RECOVERY:
   - Use the "Forgot Password" link on the login page
   - Contact support if you cannot access your account
   - Have your account information ready for verification

4. CONTACT SUPPORT:
   Email:    {{ support_email if support_email else 'support@company.com' }}
   Phone:    {{ support_phone if support_phone else 'Available via email' }}
   Hours:    {{ support_hours if support_hours else 'Monday-Friday 9AM-5PM' }}
   
   When contacting support, please provide:
   - This incident ID: {{ incident_id }}
   - Your username: {{ username if username else 'Provide your username' }}
   - The time you attempted to log in
   - Description of what happened

IF YOU DID NOT ATTEMPT TO LOG IN
-----------------------------------------------------------------------
** POTENTIAL SECURITY THREAT **

If you did not attempt to log in, this could indicate:
- Someone is trying to gain unauthorized access to your account
- Your credentials may have been compromised
- Your account is being targeted for unauthorized access

IMMEDIATE SECURITY ACTIONS REQUIRED:

1. SECURE YOUR ACCOUNT:
   - Change your password immediately from a secure device
   - Log out of all active sessions
   - Review and update your security questions
   - Enable multi-factor authentication

2. MONITOR YOUR ACCOUNTS:
   - Check for any unauthorized changes or activities
   - Review recent login history and device access
   - Monitor for any suspicious emails or notifications
   - Check other accounts that use the same password

3. REPORT THE INCIDENT:
   - Contact our security team immediately
   - Do not ignore this notification
   - Consider filing a security incident report

SECURITY TEAM CONTACT INFORMATION
-----------------------------------------------------------------------
For immediate security assistance:

Security Email:      {{ security_email if security_email else 'security@company.com' }}
Security Phone:      {{ security_phone if security_phone else '24/7 Security Hotline' }}
Emergency Contact:   {{ emergency_contact if emergency_contact else 'Available via security email' }}

Incident Reporting:  {{ incident_portal if incident_portal else 'security@company.com' }}

When reporting, include:
- This incident ID: {{ incident_id }}
- Complete incident details from this notification
- Any suspicious activity you have noticed
- Your current location and device information

TECHNICAL INFORMATION FOR SECURITY TEAMS
-----------------------------------------------------------------------
{% if security_team_data %}
Monitoring System:   Flask Security Monitor v{{ app_version if app_version else '1.0' }}
Alert Source:        {{ alert_source if alert_source else 'Authentication System' }}
Detection Method:    {{ detection_method if detection_method else 'Rate Limiting' }}
Risk Score:          {{ risk_score if risk_score else 'Medium' }}/10
Auth0 Event ID:      {{ auth0_event_id if auth0_event_id else 'N/A' }}
CloudWatch Log ID:   {{ cloudwatch_log_id if cloudwatch_log_id else 'N/A' }}
Sentry Error ID:     {{ sentry_error_id if sentry_error_id else 'N/A' }}

Container Info:      {{ container_id if container_id else 'N/A' }}
WSGI Worker:         {{ wsgi_worker_id if wsgi_worker_id else 'N/A' }}
Database Pool:       {{ db_pool_status if db_pool_status else 'Normal' }}
{% endif %}

SECURITY RECOMMENDATIONS
-----------------------------------------------------------------------
IMMEDIATE RECOMMENDATIONS:
- Enable multi-factor authentication (MFA) for enhanced security
- Use a unique, strong password for this account
- Regularly monitor your account for suspicious activity
- Keep your recovery information up to date

ONGOING SECURITY PRACTICES:
- Never share your login credentials with anyone
- Use a password manager for unique passwords
- Log out completely when using shared computers
- Be cautious of phishing emails requesting login information
- Report any suspicious communication immediately

SYSTEM SECURITY MEASURES:
- All authentication attempts are monitored and logged
- Suspicious activity triggers automatic security protocols
- Account lockouts protect against brute force attacks
- Advanced threat detection monitors for attack patterns

IMPORTANT PRIVACY NOTICE
-----------------------------------------------------------------------
This security notification contains sensitive information about your
account access attempts. Please:

- Do not forward this email to unauthorized persons
- Delete this email after taking appropriate action
- Contact security if you believe this email was sent in error
- Report any suspicious communications claiming to be from our system

AUTOMATED MONITORING INFORMATION
-----------------------------------------------------------------------
This notification was generated automatically by our security monitoring
system as part of our commitment to protecting your account. Our system
continuously monitors for:

- Unusual login patterns or timing
- Multiple failed authentication attempts
- Access from new or suspicious locations
- Potential brute force or credential stuffing attacks
- Anomalous user behavior patterns

{% if monitoring_context %}
Monitoring Context:
- Detection Rule:     {{ detection_rule if detection_rule else 'Authentication Failure Rate' }}
- Alert Threshold:    {{ alert_threshold if alert_threshold else '5 failures in 5 minutes' }}
- Current Status:     {{ monitoring_status if monitoring_status else 'Active Monitoring' }}
- Next Review:        {{ next_review if next_review else 'Continuous' }}
{% endif %}

=======================================================================
DISCLAIMER: This is an automated security notification. If you believe
you received this email in error, please contact our security team
immediately at {{ security_email if security_email else 'security@company.com' }}.

Â© {{ current_year if current_year else '2024' }} {{ company_name if company_name else 'Company Name' }}. All rights reserved.

This email was sent from an automated security monitoring system.
Please do not reply directly to this email address.
=======================================================================