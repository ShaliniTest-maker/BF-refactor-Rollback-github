{% extends "emails/base/email_base.html" %}

{% block title %}Verify Your Account - Secure Access Required{% endblock %}

{% block additional_styles %}
<style>
    /* Account verification specific styles */
    .verification-header {
        background: linear-gradient(135deg, #4CAF50 0%, #45a049 100%);
    }
    
    .verification-icon {
        width: 64px;
        height: 64px;
        margin: 0 auto 20px;
        background: rgba(255, 255, 255, 0.2);
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
    }
    
    .verification-icon svg {
        width: 32px;
        height: 32px;
        fill: #ffffff;
    }
    
    .verification-details {
        background: #f8f9fa;
        border: 1px solid #e9ecef;
        border-radius: 8px;
        padding: 25px;
        margin: 30px 0;
        text-align: left;
    }
    
    .verification-code {
        font-family: 'Courier New', monospace;
        font-size: 24px;
        font-weight: bold;
        color: #2e7d2e;
        text-align: center;
        background: #e8f5e8;
        border: 2px solid #4caf50;
        border-radius: 6px;
        padding: 15px;
        margin: 20px 0;
        letter-spacing: 3px;
    }
    
    .verification-steps {
        margin: 25px 0;
    }
    
    .verification-step {
        display: flex;
        align-items: flex-start;
        margin: 15px 0;
        padding: 12px 0;
    }
    
    .step-number {
        background: #4CAF50;
        color: white;
        border-radius: 50%;
        width: 24px;
        height: 24px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 12px;
        font-weight: bold;
        margin-right: 15px;
        flex-shrink: 0;
    }
    
    .step-content {
        flex: 1;
        font-size: 14px;
        line-height: 1.5;
        color: #495057;
    }
    
    .expiration-warning {
        background: linear-gradient(135deg, #FFF3CD 0%, #FFEAA7 100%);
        border: 1px solid #FFE08A;
        border-radius: 6px;
        padding: 20px;
        margin: 25px 0;
        text-align: center;
    }
    
    .expiration-timer {
        font-size: 18px;
        font-weight: 600;
        color: #856404;
        margin: 10px 0;
    }
    
    .verification-button {
        background: linear-gradient(135deg, #4CAF50 0%, #45a049 100%);
        color: #ffffff !important;
        padding: 18px 40px;
        font-size: 18px;
        font-weight: 600;
        border-radius: 8px;
        text-decoration: none;
        display: inline-block;
        box-shadow: 0 4px 15px rgba(76, 175, 80, 0.3);
        transition: all 0.3s ease;
    }
    
    .verification-button:hover {
        transform: translateY(-2px);
        box-shadow: 0 6px 20px rgba(76, 175, 80, 0.4);
    }
    
    .alternative-method {
        background: #ffffff;
        border: 2px solid #e9ecef;
        border-radius: 6px;
        padding: 20px;
        margin: 25px 0;
        text-align: center;
    }
    
    .token-display {
        font-family: 'Courier New', monospace;
        font-size: 14px;
        background: #f8f9fa;
        border: 1px solid #dee2e6;
        border-radius: 4px;
        padding: 10px;
        margin: 15px 0;
        word-break: break-all;
        color: #495057;
    }
    
    .security-tips {
        margin: 30px 0;
    }
    
    .security-tip {
        display: flex;
        align-items: flex-start;
        margin: 12px 0;
        font-size: 13px;
        color: #6c757d;
        line-height: 1.4;
    }
    
    .security-tip-icon {
        width: 16px;
        height: 16px;
        margin-right: 10px;
        flex-shrink: 0;
        margin-top: 2px;
    }
    
    .support-contact {
        background: #e3f2fd;
        border-left: 4px solid #2196f3;
        padding: 20px;
        margin: 25px 0;
        border-radius: 0 6px 6px 0;
    }
    
    /* Mobile optimization for verification elements */
    @media only screen and (max-width: 600px) {
        .verification-details {
            padding: 20px 15px;
        }
        
        .verification-code {
            font-size: 20px;
            letter-spacing: 2px;
            padding: 12px;
        }
        
        .verification-button {
            width: 100%;
            padding: 16px 20px;
            font-size: 16px;
        }
        
        .step-number {
            width: 20px;
            height: 20px;
            font-size: 11px;
            margin-right: 12px;
        }
        
        .step-content {
            font-size: 13px;
        }
    }
</style>
{% endblock %}

{% block header %}
<div class="verification-header email-header">
    <div class="header-content">
        <div class="verification-icon">
            <svg viewBox="0 0 24 24">
                <path d="M12,1L3,5V11C3,16.55 6.84,21.74 12,23C17.16,21.74 21,16.55 21,11V5L12,1M10,17L6,13L7.41,11.59L10,14.17L16.59,7.58L18,9L10,17Z"/>
            </svg>
        </div>
        <h1 class="header-title">Verify Your Account</h1>
        <p class="header-subtitle">Secure your access and complete your registration</p>
    </div>
</div>
{% endblock %}

{% block content %}
<h2 class="content-title">Welcome! Please Verify Your Email Address</h2>

<p class="content-text">
    Thank you for creating an account with us. To ensure the security of your account and complete 
    your registration, please verify your email address by clicking the button below.
</p>

<div class="verification-details">
    <h3 style="margin: 0 0 15px 0; font-size: 16px; color: #495057;">Account Information</h3>
    <p style="margin: 5px 0; font-size: 14px; color: #6c757d;">
        <strong>Email:</strong> {{ user_email|default('your-email@example.com') }}
    </p>
    <p style="margin: 5px 0; font-size: 14px; color: #6c757d;">
        <strong>Registration Date:</strong> {{ registration_date|default('Just now') }}
    </p>
    <p style="margin: 5px 0; font-size: 14px; color: #6c757d;">
        <strong>Account ID:</strong> {{ user_id|default('USR-XXXXXXXX') }}
    </p>
</div>

<div class="button-container">
    <a href="{{ verification_url|default('#') }}" class="verification-button">
        Verify Your Email Address
    </a>
</div>

<div class="expiration-warning">
    <h4 style="margin: 0 0 10px 0; color: #856404; font-size: 16px;">⏰ Time-Sensitive Verification</h4>
    <p class="expiration-timer">
        This verification link expires in {{ expiration_time|default('24 hours') }}
    </p>
    <p style="margin: 8px 0 0 0; font-size: 13px; color: #856404;">
        After expiration, you'll need to request a new verification email
    </p>
</div>

<div class="verification-steps">
    <h4 style="margin: 0 0 20px 0; color: #495057; font-size: 16px;">Verification Steps:</h4>
    
    <div class="verification-step">
        <div class="step-number">1</div>
        <div class="step-content">
            <strong>Click the verification button above</strong> or copy the link to your browser
        </div>
    </div>
    
    <div class="verification-step">
        <div class="step-number">2</div>
        <div class="step-content">
            <strong>Complete the verification process</strong> on our secure verification page
        </div>
    </div>
    
    <div class="verification-step">
        <div class="step-number">3</div>
        <div class="step-content">
            <strong>Access your account</strong> and start using all available features
        </div>
    </div>
</div>

{% if verification_token %}
<div class="alternative-method">
    <h4 style="margin: 0 0 15px 0; color: #495057; font-size: 14px;">Alternative Verification Method</h4>
    <p style="margin: 0 0 10px 0; font-size: 13px; color: #6c757d;">
        If the button doesn't work, visit our verification page and enter this code:
    </p>
    <div class="verification-code">{{ verification_token }}</div>
    <p style="margin: 10px 0 0 0; font-size: 12px; color: #6c757d;">
        Verification Page: <a href="{{ manual_verification_url|default('#') }}" style="color: #4CAF50;">{{ manual_verification_url|default('https://yourapp.com/verify') }}</a>
    </p>
</div>
{% endif %}

<div class="security-info">
    <h4 class="security-title">
        <svg class="security-icon" viewBox="0 0 24 24">
            <path d="M12,1L3,5V11C3,16.55 6.84,21.74 12,23C17.16,21.74 21,16.55 21,11V5L12,1M10,17L6,13L7.41,11.59L10,14.17L16.59,7.58L18,9L10,17Z"/>
        </svg>
        Security Information
    </h4>
    <div class="security-tips">
        <div class="security-tip">
            <svg class="security-tip-icon" viewBox="0 0 24 24" fill="#28a745">
                <path d="M9,20.42L2.79,14.21L5.62,11.38L9,14.77L18.88,4.88L21.71,7.71L9,20.42Z"/>
            </svg>
            This verification link is unique to your account and cannot be used by others
        </div>
        <div class="security-tip">
            <svg class="security-tip-icon" viewBox="0 0 24 24" fill="#28a745">
                <path d="M9,20.42L2.79,14.21L5.62,11.38L9,14.77L18.88,4.88L21.71,7.71L9,20.42Z"/>
            </svg>
            The link is secured with cryptographic protection and expires automatically
        </div>
        <div class="security-tip">
            <svg class="security-tip-icon" viewBox="0 0 24 24" fill="#28a745">
                <path d="M9,20.42L2.79,14.21L5.62,11.38L9,14.77L18.88,4.88L21.71,7.71L9,20.42Z"/>
            </svg>
            Always verify the sender address matches our official domain
        </div>
        <div class="security-tip">
            <svg class="security-tip-icon" viewBox="0 0 24 24" fill="#ffc107">
                <path d="M13,13H11V7H13M13,17H11V15H13M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2Z"/>
            </svg>
            Never share this verification link or code with anyone else
        </div>
    </div>
</div>

<div class="alert alert-info">
    <p style="margin: 0; font-size: 14px;">
        <strong>Didn't request this verification?</strong> If you didn't create an account with us, 
        please ignore this email. Your email address will not be used unless you complete the 
        verification process.
    </p>
</div>

<div class="support-contact">
    <h4 style="margin: 0 0 10px 0; color: #1565c0; font-size: 15px;">Need Help?</h4>
    <p style="margin: 0 0 10px 0; font-size: 13px; color: #1976d2;">
        If you're having trouble with verification or have questions about your account, 
        our support team is here to help.
    </p>
    <p style="margin: 0; font-size: 13px;">
        <strong>Support:</strong> 
        <a href="mailto:{{ support_email|default('support@yourcompany.com') }}" style="color: #1976d2;">
            {{ support_email|default('support@yourcompany.com') }}
        </a>
    </p>
</div>

{% if technical_details %}
<div class="token-display">
    <strong>Technical Details:</strong><br>
    Request ID: {{ request_id|default('REQ-' + timestamp|default('XXXXXXXXXX')) }}<br>
    Token Type: Auth0 Email Verification<br>
    Issued: {{ issued_timestamp|default('Just now') }}<br>
    Expires: {{ expiration_timestamp|default('In 24 hours') }}
</div>
{% endif %}

<p class="content-text mt-35" style="font-size: 14px; color: #6c757d;">
    This verification email was generated automatically by our secure authentication system. 
    The verification process uses industry-standard security protocols including encrypted 
    tokens and time-based expiration for your protection.
</p>
{% endblock %}

{% block header_title %}Account Verification{% endblock %}
{% block header_subtitle %}Secure Email Verification Required{% endblock %}

{% block footer_links %}
<a href="{{ privacy_policy_url|default('#') }}" class="footer-link">Privacy Policy</a>
<a href="{{ terms_of_service_url|default('#') }}" class="footer-link">Terms of Service</a>
<a href="{{ support_url|default('#') }}" class="footer-link">Contact Support</a>
<a href="{{ security_center_url|default('#') }}" class="footer-link">Security Center</a>
{% endblock %}

{% block footer %}
<p class="footer-text">
    This email contains a secure verification link for your account. Please do not forward 
    this email or share the verification link with others. If you did not request this 
    verification, please contact our support team immediately.
</p>

<div class="footer-links">
    {{ super() }}
</div>

<p class="footer-text" style="font-size: 12px; margin: 15px 0 5px 0;">
    <strong>Security Notice:</strong> This email was sent from our authenticated mail system. 
    Verification tokens are protected with ItsDangerous cryptographic signatures and Auth0 security protocols.
</p>

<p class="footer-copyright">
    © {% if current_year %}{{ current_year }}{% else %}2024{% endif %} {{ company_name|default('Your Company Name') }}. All rights reserved.<br>
    Powered by Auth0 and Flask-based secure authentication system.
</p>
{% endblock %}