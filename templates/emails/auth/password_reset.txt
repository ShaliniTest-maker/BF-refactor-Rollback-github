{#
Password Reset Request Text Email Template
==========================================

Plain text email template for password reset requests, providing fallback content 
for email clients that don't support HTML. This template maintains functional parity 
with the HTML version while ensuring optimal readability in text-only email clients.

Template Features:
- Auth0-compatible reset flow with secure token handling
- Comprehensive security messaging and token expiration information
- Clear step-by-step instructions for password reset process
- Security best practices and backup access methods
- Professional formatting optimized for text-only display

Security Considerations:
- Secure token expiration messaging
- IP address and timestamp information for security verification
- Clear instructions for reporting suspicious activity
- Consistent security messaging across all email formats
#}

{% extends "emails/base/base.txt" %}

{% block subject -%}
Password Reset Request - Your Account
{%- endblock %}

{% block preheader -%}
Reset your password securely - expires in {{ expiration_hours | default(1) }} hour{% if expiration_hours != 1 %}s{% endif %}
{%- endblock %}

{% block content -%}
{{ create_section_divider('=', 78) }}
PASSWORD RESET REQUEST
{{ create_section_divider('=', 78) }}

Hello{% if user_name %} {{ user_name }}{% endif %},

We received a request to reset the password for your account{% if user_email %} ({{ user_email }}){% endif %}. If you made this request, please follow the instructions below to create a new password.

{% if auth0_enabled %}
{{ screen_reader_text('SECURED BY AUTH0') }}
This password reset is processed through our secure Auth0 authentication service 
with enterprise-grade security.
{% endif %}

{{ create_section_divider('-', 78) }}
RESET YOUR PASSWORD
{{ create_section_divider('-', 78) }}

To reset your password, click this link or copy and paste it into your browser:

{{ format_url_for_text(reset_url, 'Password Reset Link') }}

IMPORTANT SECURITY INFORMATION:
{{ format_list_item('This link expires in ' + (expiration_hours | default(1) | string) + ' hour' + ('s' if expiration_hours != 1 else '') + ' for your security') }}
{% if expiration_time %}{{ format_list_item('Expiration time: ' + expiration_time) }}{% endif %}
{{ format_list_item('This link can only be used once') }}
{{ format_list_item('Do not share this link with anyone') }}

{{ create_section_divider('-', 78) }}
STEP-BY-STEP INSTRUCTIONS
{{ create_section_divider('-', 78) }}

1. CLICK THE RESET LINK
   Click the "Password Reset Link" above to open the secure password reset page.
   
2. CREATE A STRONG PASSWORD
   Choose a new password that is at least 8 characters long and includes a mix 
   of letters, numbers, and special characters.
   
3. CONFIRM YOUR NEW PASSWORD
   Enter your new password twice to confirm it's correct, then save your changes.
   
4. SIGN IN WITH NEW PASSWORD
   Use your new password to sign in to your account and verify everything is 
   working correctly.

{{ create_section_divider('-', 78) }}
ALTERNATIVE ACCESS METHOD
{{ create_section_divider('-', 78) }}

If the link above doesn't work, copy and paste this URL into your web browser:

{{ reset_url }}

SECURITY NOTE: This link contains a secure token and should not be shared with 
anyone. Keep this email private and delete it after resetting your password.

{{ create_section_divider('-', 78) }}
SECURITY & PRIVACY INFORMATION
{{ create_section_divider('-', 78) }}

SECURE REQUEST DETAILS:
{{ format_key_value('Request Time', request_timestamp | default('Unknown')) }}
{{ format_key_value('Source IP', request_ip | default('[Protected]')) }}
{{ format_key_value('Security Level', 'Enterprise Grade') }}
{% if auth0_enabled %}{{ format_key_value('Authentication Provider', 'Auth0 Secured') }}{% endif %}

SECURITY FEATURES:
{{ format_list_item('Cryptographically signed token that expires automatically') }}
{{ format_list_item('One-time use link becomes invalid after password reset') }}
{{ format_list_item('Token protection prevents unauthorized access') }}
{% if auth0_enabled %}{{ format_list_item('Auth0 integration provides enterprise-grade security') }}{% endif %}
{{ format_list_item('Secure password requirements enforced during reset') }}

{{ create_section_divider('-', 78) }}
DIDN'T REQUEST THIS RESET?
{{ create_section_divider('-', 78) }}

If you didn't initiate this password reset request, please take these steps:

{{ format_list_item('IGNORE this email - your account remains secure') }}
{{ format_list_item('Review your recent account activity') }}
{{ format_list_item('Ensure your email account is secure') }}
{{ format_list_item('Contact our support team if you notice suspicious activity') }}

Your password will NOT be changed unless you click the reset link and complete 
the password reset process.

{{ create_section_divider('-', 78) }}
PASSWORD SECURITY TIPS
{{ create_section_divider('-', 78) }}

When creating your new password, follow these security best practices:

{{ format_list_item('Use a unique password that you don\'t use for other accounts') }}
{{ format_list_item('Consider using a password manager to generate and store strong passwords') }}
{{ format_list_item('Enable two-factor authentication if available') }}
{{ format_list_item('Never share your password or reset links with anyone') }}
{{ format_list_item('Log out of shared computers after accessing your account') }}

{{ create_section_divider('-', 78) }}
NEED HELP?
{{ create_section_divider('-', 78) }}

If you're having trouble resetting your password or have questions about your 
account security, our support team is here to help:

{{ format_url_for_text(support_url | default('#'), 'Contact Support') }}

Support Email: {{ support_email | default('support@company.com') }}
Help Center: {{ help_center_url | default('https://help.company.com') }}

Our support team can assist with password reset issues, account security 
questions, and general account support.

{% endblock %}

{% block additional_info -%}
{{ create_section_divider('-', 78) }}
SECURITY COMPLIANCE INFORMATION
{{ create_section_divider('-', 78) }}

This password reset request was processed according to our security policies:

{{ format_key_value('Security Standard', 'Enterprise Grade Authentication') }}
{{ format_key_value('Token Encryption', 'Cryptographically Secured') }}
{{ format_key_value('Data Protection', 'GDPR Compliant') }}
{{ format_key_value('Audit Logging', 'Comprehensive Security Logs') }}

All password reset activities are logged for security monitoring and compliance 
purposes. Your privacy is protected according to our privacy policy.
{%- endblock %}

{% block action_items -%}
{{ create_section_divider('-', 78) }}
IMMEDIATE ACTIONS REQUIRED
{{ create_section_divider('-', 78) }}

To complete your password reset:

1. {{ format_list_item('Click the password reset link within ' + (expiration_hours | default(1) | string) + ' hour' + ('s' if expiration_hours != 1 else ''), '□') }}
2. {{ format_list_item('Create a strong, unique password', '□') }}
3. {{ format_list_item('Confirm your new password', '□') }}
4. {{ format_list_item('Test login with your new password', '□') }}
5. {{ format_list_item('Delete this email after successful reset', '□') }}

If you experience any issues, contact support immediately.
{%- endblock %}

{% block contact_info -%}
{{ create_section_divider('-', 78) }}
SUPPORT CONTACT INFORMATION
{{ create_section_divider('-', 78) }}

Need assistance with your password reset?

Email Support: {{ support_email | default('support@company.com') }}
Phone Support: {{ support_phone | default('1-800-SUPPORT (1-800-786-7678)') }}
Live Chat: {{ live_chat_url | default('https://help.company.com/chat') }}
Help Center: {{ help_center_url | default('https://help.company.com') }}

BUSINESS HOURS:
Monday - Friday: 9:00 AM - 6:00 PM EST
Saturday: 10:00 AM - 4:00 PM EST
Sunday: Emergency support only

For urgent security concerns, contact us immediately at any time.
{%- endblock %}

{% block footer -%}
{{ create_section_divider('=', 78) }}
{{ company_name | default('Your Company Name') | upper }} - SECURE PASSWORD RESET
{{ create_section_divider('=', 78) }}

This password reset email was sent to you because a password reset was requested 
for your account. If you believe this email was sent to you in error, please 
ignore it and contact our support team.

SECURITY NOTICE:
This email contains a secure, time-limited link for password reset. Do not 
forward this email or share the reset link with anyone. For your security, 
this link will expire automatically.

REQUEST DETAILS:
{{ format_key_value('Generated', request_timestamp | default('Unknown date and time')) }}
{% if request_ip %}{{ format_key_value('Source IP', request_ip) }}{% endif %}
{{ format_key_value('Security Level', 'Maximum') }}

{% block unsubscribe_info -%}
{{ create_section_divider('-', 40) }}
EMAIL PREFERENCES
{{ create_section_divider('-', 40) }}

This is a security-related email that cannot be unsubscribed from while your 
account is active. To manage other email preferences:

{{ format_url_for_text(preferences_url | default('https://app.company.com/preferences'), 'Manage Email Preferences') }}

{% endblock %}

{% block legal_info -%}
{{ create_section_divider('-', 40) }}
LEGAL INFORMATION
{{ create_section_divider('-', 40) }}

© {% now 'Y' %} {{ company_name | default('Company Name') }}. All rights reserved.

This message contains confidential information and is intended only for the 
individual named. If you have received this message in error, please delete 
it immediately and notify our support team.

Privacy Policy: {{ privacy_policy_url | default('https://company.com/privacy') }}
Terms of Service: {{ terms_url | default('https://company.com/terms') }}
Security Policy: {{ security_url | default('https://company.com/security') }}

{% endblock %}

{% block compliance_info -%}
{{ create_section_divider('-', 40) }}
COMPANY INFORMATION
{{ create_section_divider('-', 40) }}

{{ company_name | default('Company Name') }}
{{ company_address_line1 | default('123 Business Street') }}
{{ company_address_line2 | default('City, State 12345') }}
{{ company_country | default('United States') }}

Security Compliance: SOC 2, GDPR, CCPA
{% if auth0_enabled %}Authentication Provider: Auth0 Enterprise{% endif %}
Data Protection: Enterprise Grade Encryption

For security inquiries: {{ security_email | default('security@company.com') }}
{%- endblock %}
{%- endblock %}

{#
Template Usage Example:
=======================

To use this template in your Flask application:

from flask import render_template

def send_password_reset_email(user_email, reset_url, user_name=None):
    email_content = render_template(
        'emails/auth/password_reset.txt',
        user_email=user_email,
        user_name=user_name,
        reset_url=reset_url,
        expiration_hours=1,
        expiration_time='2024-01-15 15:30:00 UTC',
        auth0_enabled=True,
        request_timestamp='2024-01-15 14:30:00 UTC',
        request_ip='192.168.1.100',
        support_url='https://help.company.com',
        support_email='support@company.com',
        company_name='Your Company Name'
    )
    
    # Send email using your preferred email service
    send_email(
        to=user_email,
        subject='Password Reset Request - Your Account',
        body=email_content,
        content_type='text/plain'
    )

Security Best Practices:
========================

1. Always validate the reset_url parameter before rendering
2. Ensure expiration_time is set appropriately (typically 1-24 hours)
3. Log all password reset email sends for security auditing
4. Rate limit password reset requests to prevent abuse
5. Use HTTPS for all reset URLs
6. Implement proper CSRF protection on reset forms
7. Clear any existing sessions after successful password reset
8. Send confirmation email after password is successfully changed

Template Variables:
===================

Required:
- reset_url: The secure password reset URL with token
- user_email: The email address of the user requesting reset

Optional but Recommended:
- user_name: Display name of the user
- expiration_hours: Number of hours until link expires (default: 1)
- expiration_time: Formatted expiration timestamp
- auth0_enabled: Boolean indicating Auth0 integration
- request_timestamp: When the reset was requested
- request_ip: IP address of the reset request
- support_url: URL to customer support
- support_email: Support team email address
- company_name: Company or application name
- various URL parameters for links and policies

The template maintains complete functional parity with the HTML version while 
providing optimal readability for text-only email clients and accessibility tools.
#}